* { box-sizing: border-box; }
body { margin: 0; font-family: system-ui, Arial, sans-serif; line-height: 1.5; background: #121212; color: #eee; }

/* Layout */
.markdown-app { display: flex; flex-direction: column; min-height: 100vh; height: 100vh; overflow: hidden; }
.app-header { display: flex; align-items: center; justify-content: space-between; padding: .75rem 1.25rem; gap: 1rem; border-bottom: 1px solid #2a2a2a; backdrop-filter: blur(6px); position: sticky; top: 0; z-index: 10; background: rgba(18,18,18,0.85); }
.app-header h1 { font-size: 1.125rem; margin: 0; font-weight: 600; letter-spacing: .5px; }

.panes { flex: 1; display: flex; min-height: 0; }
.pane { flex: 1; display: flex; flex-direction: column; min-height: 0; }

/* Editor */
.editor-pane { border-right: 1px solid #222; overflow: hidden; }
/* (Editor removed) retained class names for layout; chat styles below */

/* Chat pane */
.chat-pane-root { display: flex; flex-direction: column; flex: 1 1 auto; min-height: 0; height: 100%; overflow: hidden; }
.chat-messages { flex: 1; min-height: 0; overflow-y: auto; padding: 1rem 1rem 1.25rem; display: flex; flex-direction: column; gap: .75rem; }
.chat-message { display: flex; }
.chat-message-user { justify-content: flex-end; }
.chat-message-ai { justify-content: flex-start; }
.chat-bubble { max-width: 78%; padding: .6rem .85rem .65rem; border-radius: 14px; font-size: .9rem; line-height: 1.4; white-space: pre-wrap; background: rgba(99,102,241,0.25); position: relative; box-shadow: 0 1px 2px rgba(0,0,0,.35); }
.chat-bubble[data-role="user"] { --bubble-bg: linear-gradient(135deg,#6366f1,#8b5cf6); color: #fff; }
.chat-bubble p { margin: 0 0 .6rem; }
.chat-bubble p:last-child { margin-bottom: 0; }
.chat-bubble pre { margin: .35rem 0 0; padding: .7rem .85rem; border-radius: 8px; font-size: .7rem; line-height: 1.4; overflow-x: auto; background: #282c34; }
.chat-bubble code { background: rgba(0,0,0,.45); padding: .15rem .35rem; border-radius: 4px; font-size: .85em; }

.chat-input-bar { display: flex; gap: .6rem; padding: .65rem .75rem; border-top: 1px solid #222; background: rgba(255,255,255,0.04); flex-shrink: 0; }
.chat-input { flex: 1; border: 1px solid #2a2a2a; background: #1e1e24; color: #eee; padding: .6rem .75rem; border-radius: 10px; font: 500 14px/1.4 system-ui, Arial, sans-serif; outline: none; }
.chat-input:focus { border-color: #6366f1; box-shadow: 0 0 0 2px rgba(99,102,241,0.5); }
.chat-send-btn { padding: .55rem 1rem; border-radius: 10px; border: 1px solid transparent; background: linear-gradient(135deg,#6366f1,#8b5cf6); color: #fff; font-weight: 600; font-size: .8rem; cursor: pointer; }
.chat-send-btn:disabled { opacity: .5; cursor: default; }
.chat-send-btn:not(:disabled):hover { filter: brightness(1.1); }
.chat-send-btn:active { transform: translateY(1px); }

/* Chat action buttons */
.chat-action-bar { display: flex; gap: .6rem; padding: .4rem .75rem 1rem; width: 100%; }
.chat-action-btn { padding: .5rem 1rem; border-radius: 10px; border: 1px solid transparent; font-weight: 600; font-size: .75rem; cursor: pointer; letter-spacing: .5px; transition: filter .15s ease, transform .15s ease; flex: 1 1 0; display: inline-flex; justify-content: center; align-items: center; }
.chat-action-btn:active { transform: translateY(1px); }
.chat-action-btn:hover { filter: brightness(1.08); }
.chat-accept-btn { background: linear-gradient(135deg,#10b981,#059669); color: #fff; box-shadow: 0 1px 2px rgba(0,0,0,.4); }
.chat-cancel-btn { background: linear-gradient(135deg,#ef4444,#dc2626); color: #fff; box-shadow: 0 1px 2px rgba(0,0,0,.4); }
/* Diff button (press-and-hold) */
.chat-diff-btn { background: linear-gradient(135deg,#fbbf24,#f59e0b); color: #111; box-shadow: 0 1px 2px rgba(0,0,0,.4); }
.chat-action-btn:disabled { opacity: .45; filter: grayscale(.45) brightness(.85); cursor: not-allowed; }

/* Typing dots */
.typing-dots { display: inline-flex; gap: 4px; }
.typing-dots span { width: 6px; height: 6px; border-radius: 50%; background: currentColor; opacity: .55; animation: typing 1s infinite ease-in-out; }
.typing-dots span:nth-child(2) { animation-delay: .15s; }
.typing-dots span:nth-child(3) { animation-delay: .3s; }
@keyframes typing { 0%, 80%, 100% { transform: translateY(0); opacity: .4; } 40% { transform: translateY(-4px); opacity: .9; } }

/* Preview */
.preview-pane { position: relative; background: linear-gradient(180deg,rgba(99,102,241,0.15),rgba(0,0,0,0.4) 220px); }
.preview-inner { overflow-y: auto; padding: 1.25rem 1.75rem 3rem; width: 100%; }

/* Markdown content styling */
.preview-inner h1, .preview-inner h2, .preview-inner h3, .preview-inner h4 { font-weight: 600; line-height: 1.2; }
.preview-inner h1 { font-size: 2rem; margin: 0 0 .75rem; }
.preview-inner h2 { font-size: 1.5rem; margin: 2rem 0 .75rem; }
.preview-inner h3 { font-size: 1.25rem; margin: 1.5rem 0 .5rem; }
.preview-inner p { margin: 0 0 1rem; }
.preview-inner ul, .preview-inner ol { padding-left: 1.25rem; margin: 0 0 1rem; }
.preview-inner blockquote { margin: 0 0 1rem; padding: .75rem 1rem; border-left: 4px solid #6366f1; background: rgba(99,102,241,0.18); border-radius: 4px; }
.preview-inner code { background: rgba(0,0,0,.45); padding: .15rem .4rem; border-radius: 4px; font-size: .85em; }
.preview-inner pre { background: #282c34; padding: .85rem 1rem; border-radius: 8px; overflow-x: auto; font-size: .85rem; line-height: 1.4; margin: 0 0 1.25rem; }
.preview-inner pre code { background: none; padding: 0; font-size: .9em; }
.preview-inner a { color: #6366f1; text-decoration: none; }
.preview-inner a:hover { text-decoration: underline; }
/* Images */
.preview-inner img { max-width: 100%; height: auto; display: block; margin: 1rem 0; border-radius: 6px; box-shadow: 0 2px 6px rgba(0,0,0,.4); background: #1e1e24; }
.preview-inner img[loading="lazy"] { opacity: .92; transition: opacity .3s ease; }
.preview-inner img[data-error="true"] { filter: grayscale(.9) brightness(.7); box-shadow: 0 0 0 2px #ef4444 inset; }

/* Utilities */
.visually-hidden { position: absolute; width: 1px; height: 1px; margin: -1px; padding: 0; border: 0; clip: rect(0 0 0 0); overflow: hidden; }

/* Responsive */
@media (max-width: 900px) {
	.panes { flex-direction: column; }
	.editor-pane { border-right: none; border-bottom: 1px solid #222; }
	.preview-inner { padding-top: 1rem; }
}
